general:
  name: httpsql
volumes:
  - name: cassandra
    path: config/cassandra.yaml
components:
  - type: template
    template: cassandra
    name: db
  - type: stateless
    name: api
    containers:
      - dir: ./
        readyCheck:
          httpGet:
            port: 80
            path: /
        envVars:
          DB_PROVIDER: cassandra
        volumeMounts:
          - volume: cassandra
            mountPath: /etc/cassandra/cassandra.yaml
    expose:
      - servicePort: 80
        containerPort: 80
        external: true
      - servicePort: 8000
        containerPort: 8000
        metricsPath: /metrics
    instances: 3
tests:
  - name: func
    containers:
      - dir: ./tests/func
  - name: perf
    containers:
      - dir: ./tests/perf
    instances: 2
